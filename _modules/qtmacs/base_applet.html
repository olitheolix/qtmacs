


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>qtmacs.base_applet &mdash; Qtmacs 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/cloud.js"></script>
    <link rel="top" title="Qtmacs 0.1 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Qtmacs 0.1 documentation</a> &raquo;</li>

          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for qtmacs.base_applet</h1><div class="highlight"><pre>
<span class="c"># Copyright 2012-2013, Oliver Nagy &lt;qtmacsdev@gmail.com&gt;</span>
<span class="c">#</span>
<span class="c"># This file is part of Qtmacs.</span>
<span class="c">#</span>
<span class="c"># Qtmacs is free software: you can redistribute it and/or modify</span>
<span class="c"># it under the terms of the GNU General Public License as published by</span>
<span class="c"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c"># (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># Qtmacs is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with Qtmacs. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Provide ``QtmacsApplet``, the base class for all Qtmacs applets.</span>

<span class="sd">To implement an applet, subclass ``QtmacsApplet``, and treat it like</span>
<span class="sd">the ``QWidget`` it was derived from, with two notable exceptions:</span>

<span class="sd">1. ``show()`` and ``hide()`` do not work; use dedicated Qtmacs layout</span>
<span class="sd">   commands (eg. ``qteMakeWindowActive``) instead. This rule only</span>
<span class="sd">   applies to the applet, not to any widgets inside the applet.</span>
<span class="sd">2. All widget instances must be registered with ``qteAddWidget``.</span>

<span class="sd">Usage example::</span>

<span class="sd">    class HelloWorldApp(QtmacsApplet):</span>
<span class="sd">        \&quot;\&quot;\&quot;</span>
<span class="sd">        A &#39;Hello world&#39; applet.</span>
<span class="sd">        \&quot;\&quot;\&quot;</span>
<span class="sd">        def __init__(self, appletID):</span>
<span class="sd">            # Initialise the base class.</span>
<span class="sd">            super().__init__(appletID)</span>

<span class="sd">            # Instantiate a QLabel and tell Qtmacs about it.</span>
<span class="sd">            label = QtGui.QLabel(&#39;Hello world.&#39;, parent=self)</span>
<span class="sd">            self.qteLabel = self.qteAddWidget(label)</span>

<span class="sd">Noteworthy facts about applets:</span>

<span class="sd">* Applets are only instantiated when ``qteNewWidget`` is called.</span>
<span class="sd">* Applets can have arbitrarily many instances, but their ``appletID``</span>
<span class="sd">  (a string) must be unique.</span>

<span class="sd">Applets always carry the following attributes:</span>

<span class="sd">* ``qteMain``: reference to ``QtmacsMain`` instance,</span>
<span class="sd">* ``qteLogger``: reference to the Qtmacs logging mechanism,</span>
<span class="sd">* ``qteVersionInformation``: instance of ``QtmacsVersionStructure``,</span>
<span class="sd">* ``_qteActiveWidget``: the widget currently active inside the applet.</span>

<span class="sd">The first three attributes are fixed for entire life of the applet,</span>
<span class="sd">whereas the last attribute is updated by Qtmacs and always points to</span>
<span class="sd">the active widget inside the applet (this may be **None**).</span>

<span class="sd">It is safe to use::</span>

<span class="sd">    from applet import QtmacsApplet</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sip</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">qtmacs.auxiliary</span>
<span class="kn">import</span> <span class="nn">qtmacs.type_check</span>
<span class="kn">import</span> <span class="nn">qtmacs.qte_global</span> <span class="kn">as</span> <span class="nn">qte_global</span>

<span class="kn">from</span> <span class="nn">PyQt4</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">qtmacs.exceptions</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Shorthands</span>
<span class="n">type_check</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">type_check</span><span class="o">.</span><span class="n">type_check</span>
<span class="n">QtmacsKeymap</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">QtmacsKeymap</span>
<span class="n">QtmacsMessage</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">QtmacsMessage</span>
<span class="n">QtmacsKeysequence</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">QtmacsKeysequence</span>
<span class="n">QtmacsAdminStructure</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">QtmacsAdminStructure</span>
<span class="n">QtmacsVersionStructure</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">QtmacsVersionStructure</span>
<span class="n">qteIsQtmacsWidget</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">qteIsQtmacsWidget</span>
<span class="n">qteGetAppletFromWidget</span> <span class="o">=</span> <span class="n">qtmacs</span><span class="o">.</span><span class="n">auxiliary</span><span class="o">.</span><span class="n">qteGetAppletFromWidget</span>


<div class="viewcode-block" id="QtmacsApplet"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet">[docs]</a><span class="k">class</span> <span class="nc">QtmacsApplet</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for every Qtmacs (mini) applet.</span>

<span class="sd">    For all practical purposes this class should be considered a</span>
<span class="sd">    QWidget class that can be filled with arbitrary widgets in order</span>
<span class="sd">    to display the desired functionality. The main difference between</span>
<span class="sd">    this class and a native QWidget, again from a practical point of</span>
<span class="sd">    view, is that none of the widgets added with ``qteAddWidget`` will</span>
<span class="sd">    react to keyboard inputs. Instead, macros are required to</span>
<span class="sd">    implement this functionality.</span>

<span class="sd">    The methods of this class are almost exclusively interfaces to</span>
<span class="sd">    ``QtmacsMain`` to administrate the applet. Consequently, there</span>
<span class="sd">    should be no need to overload any of its existing methods.</span>

<span class="sd">    Every applet has the following three attributes available to them</span>
<span class="sd">    at run time:</span>

<span class="sd">    * ``qteMain``: reference to QtmacsMain instance (comes straight</span>
<span class="sd">      from the global variables).</span>
<span class="sd">    * ``qteLogger``: the Qtmacs wide logger (see ``logger`` module</span>
<span class="sd">      in Python standard library).</span>
<span class="sd">    * ``_qteActiveWidget``: the widget currently active inside the applet.</span>
<span class="sd">    * ``qteVersionInformation``: version information.</span>

<span class="sd">    |Args|</span>

<span class="sd">    * ``appletID`` (**str**): unique ID used by ``QtmacsMain`` to</span>
<span class="sd">      distinguish applets.</span>

<span class="sd">    |Raises|</span>

<span class="sd">    * **QtmacsArgumentError** if appletID is not a string.</span>
<span class="sd">    * **QtmacsOthertError** if the appletID is not unique.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@type_check</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">appletID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="c"># Raise an error if an applet with the same ID already exists.</span>
        <span class="k">if</span> <span class="n">qte_global</span><span class="o">.</span><span class="n">qteMain</span><span class="o">.</span><span class="n">qteGetAppletHandle</span><span class="p">(</span><span class="n">appletID</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;Applet with ID &lt;b&gt;{}&lt;/b&gt; already exists&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">appletID</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">QtmacsOtherError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c"># Destroy the object when its close() method is called.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WA_DeleteOnClose</span><span class="p">)</span>

        <span class="c"># Install the admin structure that contains information about</span>
        <span class="c"># this applet.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span> <span class="o">=</span> <span class="n">QtmacsAdminStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">appletID</span><span class="o">=</span><span class="n">appletID</span><span class="p">)</span>

        <span class="c"># Reference to QtmacsMain instance and its logger.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteMain</span> <span class="o">=</span> <span class="n">qte_global</span><span class="o">.</span><span class="n">qteMain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qteMain</span><span class="o">.</span><span class="n">qteLogger</span>

        <span class="c"># Version information for this applet.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteVersionInformation</span> <span class="o">=</span> <span class="n">QtmacsVersionStructure</span><span class="p">()</span>

        <span class="c"># Give the widget a custom background color (I do not know how</span>
        <span class="c"># to actually specify this color though).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAutoFillBackground</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="c"># The widget currently considered active inside this applet.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># The currently active modes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteModes</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c"># The default applet signature is identical with the class name.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteSetAppletSignature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__qteRegisterAppletInit__</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Triggered by ``qteRegisterApplet`` when the applet is registered.</span>

<span class="sd">        This method will only be executed once, namely when the applet</span>
<span class="sd">        is registered with Qtmacs via ``qteRegisterApplet``. It will</span>
<span class="sd">        *not* be called again for any instances of the class.</span>

<span class="sd">        The purpose of this method is to perform setup tasks that do</span>
<span class="sd">        not depend on a particular instance. Examples for this would</span>
<span class="sd">        be to update ``findFile_types`` in `qte_global.py` so that</span>
<span class="sd">        find-file know that this applet can deal with them, or to</span>
<span class="sd">        verify that the conditions for this applet are met (eg. check</span>
<span class="sd">        that third party modules and external libraries are</span>
<span class="sd">        available), or to initialise the the module name space of the</span>
<span class="sd">        object.</span>

<span class="sd">        If no such setup is required then it does not need to be</span>
<span class="sd">        overloaded (the default implementation does nothing).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="QtmacsApplet.mousePressEvent"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.mousePressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prevent mouse clicks from being propagated further.</span>

<span class="sd">        The sole purpose of this (stub) method is to declare the event</span>
<span class="sd">        handled to avoid calling the event handler more often than</span>
<span class="sd">        necessary. Without this method, Qt would generate another</span>
<span class="sd">        mouse event for the parent because applets themselves do not</span>
<span class="sd">        accept mouse clicks. Since the parent is likely another widget</span>
<span class="sd">        that does not accept the focus (eg. a QtmacsSplitter) there</span>
<span class="sd">        would be several calls to no avail until the top level window</span>
<span class="sd">        is reached.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteParentWindow"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteParentWindow">[docs]</a>    <span class="k">def</span> <span class="nf">qteParentWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a reference to the parent window.</span>
<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **QtmacsWindow**: the parent window.</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">parentWindow</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteReparent"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteReparent">[docs]</a>    <span class="k">def</span> <span class="nf">qteReparent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Re-parent the applet.</span>

<span class="sd">        This is little more then calling Qt&#39;s native ``setParent()``</span>
<span class="sd">        method but also updates the ``qteParentWindow`` handle. This</span>
<span class="sd">        method is usually called when the applet is added/removed from</span>
<span class="sd">        a splitter and thus requires re-parenting.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``parent`` (**QWidget**): the new parent of this object.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Set the new parent.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="c"># If this parent has a Qtmacs structure then query it for the</span>
        <span class="c"># parent window, otherwise set the parent to None.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">parentWindow</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">qteParentWindow</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">parentWindow</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="c"># Sanity check:</span>
            <span class="k">if</span> <span class="n">parent</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;Parent is neither None, nor does it have a&#39;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;qteParentWindow field --&gt; bug&#39;</span>
                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.qteAddWidget"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteAddWidget">[docs]</a>    <span class="k">def</span> <span class="nf">qteAddWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widgetObj</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span> <span class="n">isFocusable</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                     <span class="n">widgetSignature</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">autoBind</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Augment the standard Qt ``widgetObj`` with Qtmacs specific fields.</span>

<span class="sd">        Example: from a programmers perspective there is no difference</span>
<span class="sd">        between::</span>

<span class="sd">            wid = QtGui.QTextEdit(self)</span>

<span class="sd">        and::</span>

<span class="sd">            wid = self.qteAddWidget(QtGui.QTextEdit(self))</span>

<span class="sd">        Both return a handle to a Qt widget (a ``QTextEdit`` in this</span>
<span class="sd">        case). However, the ``qteAddWidget`` adds the following fields</span>
<span class="sd">        to the object:</span>

<span class="sd">        * ``_qteAdmin``: this is an instance of the ``QtmacsAdminStructure``</span>
<span class="sd">          to tell Qtmacs how to treat the widget.</span>
<span class="sd">        * ``qteSignature``: an attribute that returns the signature of the</span>
<span class="sd">          widget and equals ``widgetSignature``. If no such signature was</span>
<span class="sd">          specified it defaults to the Qt internal name as a string, eg.</span>
<span class="sd">          for a push button this would be &#39;QPushButton&#39;.</span>
<span class="sd">        * ``qteSetKeyFilterPolicy``: this points directly to the equally</span>
<span class="sd">          named method inside the _qteAdmin object. This is a convenience</span>
<span class="sd">          shortcut to avoid using the _qteAdmin structure directly in</span>
<span class="sd">          macro/applet code, because only Qtmacs itself should temper</span>
<span class="sd">          with it.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``widgetObj`` (**QWidget**): any widget from the QtGui library.</span>
<span class="sd">        * ``isFocusable`` (**bool**): whether or not the widget can</span>
<span class="sd">          receive the focus.</span>
<span class="sd">        * ``widgetSignature`` (**str**): specify the widget signature</span>
<span class="sd">          (defaults to class name)</span>
<span class="sd">        * ``autoBind`` (**bool**): if **True** and ``widgetSignature``</span>
<span class="sd">          is a recognisable name (eg. **QTextEdit**) then automatically</span>
<span class="sd">          load the appropriate key-bindings for this widget.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **QWidget**: handle to widget object (or **None** if it could</span>
<span class="sd">          not be added).</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsArgumentError** if at least one argument has an invalid type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Add a Qtmacs data structure to the widget to allow their</span>
        <span class="c"># event administration. Note that, in all likelihood, the</span>
        <span class="c"># widget is an arbitrary Qt widget (eg. QLineEdit,</span>
        <span class="c"># QPushButton, etc).</span>
        <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span> <span class="o">=</span> <span class="n">QtmacsAdminStructure</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">isFocusable</span><span class="o">=</span><span class="n">isFocusable</span><span class="p">)</span>
        <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">appletID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">appletID</span>

        <span class="c"># Specify that this widget is not a QtmacsApplet.</span>
        <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isQtmacsApplet</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c"># Remember the signature of the applet containing this widget.</span>
        <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">appletSignature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qteAppletSignature</span><span class="p">()</span>

        <span class="c"># Set the widget signature. If none was specified, use the</span>
        <span class="c"># class name (eg. QLineEdit).</span>
        <span class="k">if</span> <span class="n">widgetSignature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetSignature</span> <span class="o">=</span> <span class="n">widgetObj</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetSignature</span> <span class="o">=</span> <span class="n">widgetSignature</span>

        <span class="c"># For convenience, as it is otherwise difficult for the macro</span>
        <span class="c"># programmer to determine the widget signature used by Qtmacs.</span>
        <span class="c"># Note: the &quot;wo&quot; is only a shorthand to avoid too long lines.</span>
        <span class="n">wo</span> <span class="o">=</span> <span class="n">widgetObj</span>
        <span class="n">wo</span><span class="o">.</span><span class="n">qteSignature</span> <span class="o">=</span> <span class="n">wo</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetSignature</span>
        <span class="n">wo</span><span class="o">.</span><span class="n">qteSetKeyFilterPolicy</span> <span class="o">=</span> <span class="n">wo</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">qteSetKeyFilterPolicy</span>
        <span class="k">del</span> <span class="n">wo</span>

        <span class="c"># Add the widget to the widgetList of this QtmacsApplet.</span>
        <span class="c"># Important: this MUST happen before macros and key-bindings are loaded</span>
        <span class="c"># and bound automatically (see code below) because the method to</span>
        <span class="c"># bind the keys will verify that the widget exists in ``widgetList``.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">widgetObj</span><span class="p">)</span>

        <span class="c"># If a widget has a default key-bindings file then the global</span>
        <span class="c"># dictionary ``default_widget_keybindings`` will contain its</span>
        <span class="c"># name.</span>
        <span class="n">default_bind</span> <span class="o">=</span> <span class="n">qte_global</span><span class="o">.</span><span class="n">default_widget_keybindings</span>
        <span class="k">if</span> <span class="n">autoBind</span> <span class="ow">and</span> <span class="p">(</span><span class="n">widgetObj</span><span class="o">.</span><span class="n">qteSignature</span> <span class="ow">in</span> <span class="n">default_bind</span><span class="p">):</span>
            <span class="c"># Shorthand.</span>
            <span class="n">module_name</span> <span class="o">=</span> <span class="n">default_bind</span><span class="p">[</span><span class="n">widgetObj</span><span class="o">.</span><span class="n">qteSignature</span><span class="p">]</span>

            <span class="c"># Import the module with the default key-bindings for the</span>
            <span class="c"># current widget type.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Module &lt;b&gt;{}&lt;/b&gt; could not be imported.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                       <span class="n">module_name</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s">&#39;install_macros_and_bindings&#39;</span><span class="p">):</span>
                <span class="c"># By convention, the module has an</span>
                <span class="c"># install_macros_and_bindings method. If an error</span>
                <span class="c"># occurs intercept it, but do not abort the method</span>
                <span class="c"># since the error only relates to a failed attempt to</span>
                <span class="c"># apply default key-bindings, not to register the</span>
                <span class="c"># widget (the main purpose of this method).</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">mod</span><span class="o">.</span><span class="n">install_macros_and_bindings</span><span class="p">(</span><span class="n">widgetObj</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;&lt;b&gt;install_macros_and_bindings&lt;/b&gt; function&#39;</span>
                           <span class="s">&#39; in &lt;b&gt;{}&lt;/b&gt; did not execute properly.&#39;</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Module &lt;b&gt;{}&lt;/b&gt; has no &#39;</span>
                       <span class="s">&#39;&lt;b&gt;install_macros_and_bindings&lt;/b&gt;&#39;</span>
                       <span class="s">&#39; method&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">widgetObj</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.qteSetAppletSignature"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteSetAppletSignature">[docs]</a>    <span class="k">def</span> <span class="nf">qteSetAppletSignature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signature</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specify the applet signature.</span>

<span class="sd">        This signature is used by Qtmacs at run time to determine</span>
<span class="sd">        which macros are compatible with the apple. Macros have an</span>
<span class="sd">        identically called method so that Qtmacs can determine which</span>
<span class="sd">        macros are compatible with which applets. This method is</span>
<span class="sd">        typically called only in the applet constructor, but changing</span>
<span class="sd">        the macro signature at run time, is possible.</span>

<span class="sd">        The signature must be a non-empty string and not contain the</span>
<span class="sd">        &#39;*&#39; symbol.</span>

<span class="sd">        Note: the default signature is the class name as a string,</span>
<span class="sd">        eg. if the applet class is called MyAppClass, then the initial</span>
<span class="sd">        macro signature is the string &#39;MyAppClass&#39;.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``signature`` (**str**): the signature of this applet to</span>
<span class="sd">          determine compatible macros run time.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsArgumentError** if at least one argument has an invalid type.</span>
<span class="sd">        * **QtmacsOtherError** if the signature is empty or contains</span>
<span class="sd">          the &#39;*&#39; wildcard symbol.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">signature</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">QtmacsOtherError</span><span class="p">(</span><span class="s">&#39;The applet signature must not contain &quot;*&quot;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">signature</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">QtmacsOtherError</span><span class="p">(</span><span class="s">&#39;The applet signature must be non-empty&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">appletSignature</span> <span class="o">=</span> <span class="n">signature</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteAppletSignature"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteAppletSignature">[docs]</a>    <span class="k">def</span> <span class="nf">qteAppletSignature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the signature (a string) of this applet.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **str**: the signature of this applet as set by</span>
<span class="sd">            ``qteSetAppletSignature``</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">appletSignature</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteAutoremoveDeletedWidgets"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteAutoremoveDeletedWidgets">[docs]</a>    <span class="k">def</span> <span class="nf">qteAutoremoveDeletedWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove all widgets from the internal widget list that do not</span>
<span class="sd">        exist anymore according to SIP.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">widget_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span>
        <span class="n">deleted_widgets</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">widget_list</span> <span class="k">if</span> <span class="n">sip</span><span class="o">.</span><span class="n">isdeleted</span><span class="p">(</span><span class="n">_</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">widgetObj</span> <span class="ow">in</span> <span class="n">deleted_widgets</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">widgetObj</span><span class="p">)</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.qteSetWidgetFocusOrder"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteSetWidgetFocusOrder">[docs]</a>    <span class="k">def</span> <span class="nf">qteSetWidgetFocusOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widList</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the focus order of the widgets in this applet.</span>

<span class="sd">        This method re-arranges the internal (cyclic) widget list so</span>
<span class="sd">        that all widgets specified in ``widList`` will be focused in</span>
<span class="sd">        the given order.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``widList`` (**tuple**): a tuple of widget objects.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># A list with less than two entries cannot be re-ordered.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">widList</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c"># Housekeeping: remove non-existing widgets from the admin structure.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteAutoremoveDeletedWidgets</span><span class="p">()</span>

        <span class="c"># Remove all **None** widgets.</span>
        <span class="n">widList</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">widList</span> <span class="k">if</span> <span class="n">_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>

        <span class="c"># Ensure that all widgets exist in the current applet.</span>
        <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">widList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">wid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;Cannot change focus order because some &#39;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;widgets do not exist.&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c"># Remove all duplicates from the user supplied list.</span>
        <span class="n">newList</span> <span class="o">=</span> <span class="p">[</span><span class="n">widList</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">widList</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">wid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">newList</span><span class="p">:</span>
                <span class="n">newList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wid</span><span class="p">)</span>

        <span class="c"># If the duplicate free list has only one entry then there is</span>
        <span class="c"># nothing left to reorder.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">newList</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c"># The purpose of the code is the following: suppose</span>
        <span class="c"># _qteAdmin.widgetList = [0,1,2,3,4,5] and newList=[2,5,1].</span>
        <span class="c"># Then change _qteAdmin.widgetList to [0,1,2,5,1,3,4]. Step</span>
        <span class="c"># 1: remove all but the first widget in newList from</span>
        <span class="c"># _qteAdmin.widgetList.</span>
        <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">newList</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">wid</span><span class="p">)</span>

        <span class="c"># 2: re-insert the removed elements as a sequence again.</span>
        <span class="n">startIdx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">wid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">newList</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">startIdx</span> <span class="o">+</span> <span class="n">idx</span><span class="p">,</span> <span class="n">wid</span><span class="p">)</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.qteNextWidget"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteNextWidget">[docs]</a>    <span class="k">def</span> <span class="nf">qteNextWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numSkip</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ofsWidget</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">skipVisible</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">skipInvisible</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                      <span class="n">skipFocusable</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                      <span class="n">skipUnfocusable</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the next widget in cyclic order.</span>

<span class="sd">        If ``ofsWidget`` is **None** then start counting at the</span>
<span class="sd">        currently active widget and return the applet ``numSkip``</span>
<span class="sd">        items away in cyclic order in the internal widget list. If</span>
<span class="sd">        ``numSkip`` is positive traverse the applet list forwards,</span>
<span class="sd">        otherwise backwards. The methods supports the following</span>
<span class="sd">        selection criteria:</span>

<span class="sd">        * ``skipVisible``: only invisible widgets are considered.</span>
<span class="sd">        * ``skipInvisible``: only visible widgets are considered.</span>
<span class="sd">        * ``skipFocusable``: only unfocusable widgets are considered.</span>
<span class="sd">        * ``skipUnfocusable``: only unfocusable widgets are considered.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``numSkip`` (**int**): number of applets to skip.</span>
<span class="sd">        * ``ofsWidget`` (**QWidget**): widget from where to start counting.</span>
<span class="sd">        * ``skipVisible`` (**bool**): whether or not to skip currently</span>
<span class="sd">          shown widgets.</span>
<span class="sd">        * ``skipInvisible`` (**bool**): whether or not to skip currently</span>
<span class="sd">          not shown widgets.</span>
<span class="sd">        * ``skipFocusable`` (**bool**): whether or not to skip focusable</span>
<span class="sd">          widgets.</span>
<span class="sd">        * ``skipUnfocusable`` (**bool**): whether or not to skip unfocusable</span>
<span class="sd">          widgets.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **QWidget**: either the next widget that fits the criteria, or</span>
<span class="sd">          **None** if no such widget exists.</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsArgumentError** if at least one argument has an invalid type.</span>
<span class="sd">        * **QtmacsOtherError** if ``ofsWidget`` was not added with</span>
<span class="sd">          ``qteAddWidget``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Check type of input arguments.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ofsWidget</span><span class="p">,</span> <span class="s">&#39;_qteAdmin&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ofsWidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;&lt;ofsWidget&gt; was probably not added with &lt;qteAddWidget&gt;&#39;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39; method because it lacks the &lt;_qteAdmin&gt; attribute.&#39;</span>
            <span class="k">raise</span> <span class="n">QtmacsOtherError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c"># Housekeeping: remove non-existing widgets from the admin structure.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteAutoremoveDeletedWidgets</span><span class="p">()</span>

        <span class="c"># Make a copy of the widget list.</span>
        <span class="n">widList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="p">)</span>

        <span class="c"># Return immediately if the widget list is empty. The actual</span>
        <span class="c"># return value is either self._qteActiveWidget (if it points</span>
        <span class="c"># to a child widget of the current applet), or None.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">widList</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">qteGetAppletFromWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">skipInvisible</span><span class="p">:</span>
            <span class="c"># Remove all invisible widgets.</span>
            <span class="n">widList</span> <span class="o">=</span> <span class="p">[</span><span class="n">wid</span> <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">widList</span> <span class="k">if</span> <span class="n">wid</span><span class="o">.</span><span class="n">isVisible</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">skipVisible</span><span class="p">:</span>
            <span class="c"># Remove all visible widgets.</span>
            <span class="n">widList</span> <span class="o">=</span> <span class="p">[</span><span class="n">wid</span> <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">widList</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">wid</span><span class="o">.</span><span class="n">isVisible</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">skipFocusable</span><span class="p">:</span>
            <span class="c"># Remove all visible widgets.</span>
            <span class="n">widList</span> <span class="o">=</span> <span class="p">[</span><span class="n">wid</span> <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">widList</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">wid</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isFocusable</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">skipUnfocusable</span><span class="p">:</span>
            <span class="c"># Remove all unfocusable widgets.</span>
            <span class="n">widList</span> <span class="o">=</span> <span class="p">[</span><span class="n">wid</span> <span class="k">for</span> <span class="n">wid</span> <span class="ow">in</span> <span class="n">widList</span> <span class="k">if</span> <span class="n">wid</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isFocusable</span><span class="p">]</span>

        <span class="c"># Return immediately if the list is empty. This is typically</span>
        <span class="c"># the case at startup before any applet has been added.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">widList</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="c"># If no offset widget was given then use the currently active one.</span>
        <span class="k">if</span> <span class="n">ofsWidget</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ofsWidget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">ofsWidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">numSkip</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">qteIsQtmacsWidget</span><span class="p">(</span><span class="n">ofsWidget</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">ofsWidget</span>

        <span class="c"># Determine the index of the offset widget; assume it is zero</span>
        <span class="c"># if the widget does not exist, eg. if the currently active</span>
        <span class="c"># applet is not part of the pruned widList list.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ofsIdx</span> <span class="o">=</span> <span class="n">widList</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ofsWidget</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">ofsIdx</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c"># Compute the index of the next widget and wrap around the</span>
        <span class="c"># list if necessary.</span>
        <span class="n">ofsIdx</span> <span class="o">=</span> <span class="p">(</span><span class="n">ofsIdx</span> <span class="o">+</span> <span class="n">numSkip</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">widList</span><span class="p">)</span>

        <span class="c"># Return the widget.</span>
        <span class="k">return</span> <span class="n">widList</span><span class="p">[</span><span class="n">ofsIdx</span><span class="p">]</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.qteMakeWidgetActive"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteMakeWidgetActive">[docs]</a>    <span class="k">def</span> <span class="nf">qteMakeWidgetActive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widgetObj</span><span class="p">:</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Give keyboard focus to ``widgetObj``.</span>

<span class="sd">        If ``widgetObj`` is **None** then the internal focus state</span>
<span class="sd">        is reset, but the focus manger will automatically</span>
<span class="sd">        activate the first available widget again.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``widgetObj`` (**QWidget**): the widget to focus on.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsOtherError** if ``widgetObj`` was not added with</span>
<span class="sd">            ``qteAddWidget``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Void the active widget information.</span>
        <span class="k">if</span> <span class="n">widgetObj</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">return</span>

        <span class="c"># Ensure that this applet is an ancestor of ``widgetObj``</span>
        <span class="c"># inside the Qt hierarchy.</span>
        <span class="k">if</span> <span class="n">qteGetAppletFromWidget</span><span class="p">(</span><span class="n">widgetObj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;The specified widget is not inside the current applet.&#39;</span>
            <span class="k">raise</span> <span class="n">QtmacsOtherError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c"># If widgetObj is not registered with Qtmacs then simply declare</span>
        <span class="c"># it active and return.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">widgetObj</span><span class="p">,</span> <span class="s">&#39;_qteAdmin&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span> <span class="o">=</span> <span class="n">widgetObj</span>
            <span class="k">return</span>

        <span class="c"># Do nothing if widgetObj refers to an applet.</span>
        <span class="k">if</span> <span class="n">widgetObj</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isQtmacsApplet</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">return</span>

        <span class="c"># Housekeeping: remove non-existing widgets from the admin structure.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteAutoremoveDeletedWidgets</span><span class="p">()</span>

        <span class="c"># Verify the widget is registered for this applet.</span>
        <span class="k">if</span> <span class="n">widgetObj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetList</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;Widget is not registered for this applet.&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">return</span>

        <span class="c"># The focus manager in QtmacsMain will hand the focus to</span>
        <span class="c"># whatever the _qteActiveWidget variable of the active applet</span>
        <span class="c"># points to.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteSetWidgetFocusOrder</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span><span class="p">,</span> <span class="n">widgetObj</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteActiveWidget</span> <span class="o">=</span> <span class="n">widgetObj</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteAppletID"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteAppletID">[docs]</a>    <span class="k">def</span> <span class="nf">qteAppletID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the applet ID.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **str**: applet ID.</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">appletID</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteKeyPressEventBefore"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteKeyPressEventBefore">[docs]</a>    <span class="k">def</span> <span class="nf">qteKeyPressEventBefore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">srcObj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Virtual method: triggers just before the key is processed by Qtmacs.</span>

<span class="sd">        This function is only called if ``receiveBeforeQtmacsParser``</span>
<span class="sd">        was explicitly set with the ``qteSetKeyFilterPolicy`` method</span>
<span class="sd">        of ``srcObj``.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``event`` (**QKeyEvent**): the key event passed down by Qt itself.</span>
<span class="sd">        * ``srcObj`` (**QWidget**): object that received the key event.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteKeyPressEventAfter"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteKeyPressEventAfter">[docs]</a>    <span class="k">def</span> <span class="nf">qteKeyPressEventAfter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">srcObj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Virtual method: triggers after the key was processed by Qtmacs.</span>

<span class="sd">        This function is only called if ``receiveBeforeQtmacsParser``</span>
<span class="sd">        was explicitly set with the ``qteSetKeyFilterPolicy`` method</span>
<span class="sd">        of ``srcObj``.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``event`` (**QKeyEvent**): the key event passed down by Qt itself.</span>
<span class="sd">        * ``srcObj`` (**QWidget**): object that received the key event.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.keyPressEvent"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Qt-native slot.</span>

<span class="sd">        This slot can only be triggered if the event filter of Qtmacs</span>
<span class="sd">        is not in control of this applet for whatever reason. This</span>
<span class="sd">        implies that none of the macro associated with keys will run</span>
<span class="sd">        and Qtmacs is therefore unresponsive. However, the method</span>
<span class="sd">        raises an error which *should* ensure that Qtmacs will restore</span>
<span class="sd">        itself, but the problem should nonetheless not be present in</span>
<span class="sd">        the first place.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;Main applet received keyboard event. &#39;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;This is almost certainly a bug.&#39;</span>
        <span class="k">raise</span> <span class="n">QtmacsOtherError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteIsVisible"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteIsVisible">[docs]</a>    <span class="k">def</span> <span class="nf">qteIsVisible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns **True** if the window is visible according to Qtmacs.</span>

<span class="sd">        Note that this flag is set as soon as Qtmacs scheduled it to</span>
<span class="sd">        become visible, but it may not yet be visible because the</span>
<span class="sd">        event loop has not yet been called. This is also the reason</span>
<span class="sd">        why this flag may differ from Qt&#39;s native ``isVisible``.</span>

<span class="sd">        Note that more than one applet may have this flag set because</span>
<span class="sd">        multiple applets might have been scheduled to become visible,</span>
<span class="sd">        even if they are mutually exclusively. However, once the GUI</span>
<span class="sd">        was updated the focus manager ensures that the flags are</span>
<span class="sd">        consistent again.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **bool**: visibility status of applet according to Qtmacs,</span>
<span class="sd">            not Qt.</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isVisible</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.qteSetReadyToKill"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteSetReadyToKill">[docs]</a>    <span class="k">def</span> <span class="nf">qteSetReadyToKill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If **True**, then the default ``kill-applet`` macro will</span>
<span class="sd">        delete us immediately if triggered.</span>

<span class="sd">        The purpose of this method is to ensure that no applets are</span>
<span class="sd">        accidentally killed when they contain eg. unsaved</span>
<span class="sd">        data. However, heeding this flag is the responsibility of the</span>
<span class="sd">        macros, whereas the ``qteKillApplet`` method from ``Qtmacs``</span>
<span class="sd">        will do as told.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``flag`` (**bool**): if **True**, the applet can be safely killed.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">readyToKill</span> <span class="o">=</span> <span class="n">flag</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteReadyToKill"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteReadyToKill">[docs]</a>    <span class="k">def</span> <span class="nf">qteReadyToKill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the ``readyToKill`` status for this applet.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **bool**: if **True**, the applet can be safely killed.</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">readyToKill</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.qteToBeKilled"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.qteToBeKilled">[docs]</a>    <span class="k">def</span> <span class="nf">qteToBeKilled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cleanup actions.</span>

<span class="sd">        This method is a stub and called immediately before Qtmacs</span>
<span class="sd">        kills the applet.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.loadFile"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.loadFile">[docs]</a>    <span class="k">def</span> <span class="nf">loadFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overload this method with applet specific code that can make</span>
<span class="sd">        sense of the passed ``fileName`` argument. In many case this</span>
<span class="sd">        will literally mean a file name, but could equally well be a</span>
<span class="sd">        URL (eg. ``QWebView`` based applets) or any other resource</span>
<span class="sd">        descriptor, as long as it is in text form.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``fileName`` (**str**): name of file to open.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;The &lt;b&gt;{}&lt;/b&gt; applet has not implemented the &#39;</span>
               <span class="s">&#39;&lt;b&gt;LoadFile&lt;/b&gt; method&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qteAppletSignature</span><span class="p">()))</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.show"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromQtmacs</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overloaded ``show()`` function to avoid calling it</span>
<span class="sd">        accidentally.</span>

<span class="sd">        This method is a (weak) security mechanism to prevent</span>
<span class="sd">        programmers from using the ``show`` method as originally</span>
<span class="sd">        intended by Qt, ie. to show a window. In Qtmacs, applets can</span>
<span class="sd">        only be made visible with either ``qteMakeAppletActive`` or by</span>
<span class="sd">        replacing another window in the layout with eg</span>
<span class="sd">        ``qteReplaceWindowInLayout``. Using the Qt native ``show()``</span>
<span class="sd">        method messes with the Qtmacs layout engine and can lead to</span>
<span class="sd">        unexpected visual results and more serious errors.</span>

<span class="sd">        This method should only be used by ``QtmacsMain`` to implement</span>
<span class="sd">        the layout but not by any applets or macros, unless it is for</span>
<span class="sd">        a widget not under the control of Qtmacs (probably a bad</span>
<span class="sd">        idea).</span>

<span class="sd">        The user should call the ``qteNewApplet`` method to create and</span>
<span class="sd">        show a applet.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * ``fromQtmacs`` (**bool**): if **True** then the original</span>
<span class="sd">          ``show()`` method is called</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsArgumentError** if at least one argument has an invalid type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fromQtmacs</span><span class="p">:</span>
            <span class="c"># Log a warning message if someone tries to call the</span>
            <span class="c"># native show() method.</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;show() command for applet &lt;b&gt;{}&lt;/b&gt; ignored. &#39;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39; Use qteNewApplet instead.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qteAppletID</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Sanity check: the parent of this applet *must* be a</span>
            <span class="c"># ``QtmacsLayoutSplitter`` as otherwise it cannot be</span>
            <span class="c"># shown.</span>
            <span class="n">sig_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">widgetSignature</span>
            <span class="k">if</span> <span class="n">sig_</span> <span class="o">!=</span> <span class="s">&#39;__QtmacsLayoutSplitter__&#39;</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;show() command for applet &lt;b&gt;{}&lt;/b&gt; ignored&#39;</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qteAppletID</span><span class="p">())</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39; because its parent is not a &#39;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;QtmacsLayoutSplitter --&gt; Bug.&#39;</span>
                <span class="k">return</span>

            <span class="c"># Before the applet is actually shown update the</span>
            <span class="c"># ``parentWindow`` reference in the admin structure. To</span>
            <span class="c"># obtain this reference, query the parent of this very</span>
            <span class="c"># applet (which is a QtmacsSplitter instance) for its</span>
            <span class="c"># parent window since both must necessarily be shown in</span>
            <span class="c"># the same window and thus have the same parent window.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">parentWindow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">qteParentWindow</span><span class="p">()</span>

            <span class="c"># Update the Qtmacs internal visibility flag (used in the</span>
            <span class="c"># focus manager to ensure that Qt and Qtmacs agree on</span>
            <span class="c"># which applets are visible and which are not) and then</span>
            <span class="c"># tell Qt to make the applet visible once the event loop</span>
            <span class="c"># regains control.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isVisible</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.hide"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.hide">[docs]</a>    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromQtmacs</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overloaded ``hide()`` function to avoid calling it</span>
<span class="sd">        accidentally.</span>

<span class="sd">        This method is a (weak) security mechanism to prevent</span>
<span class="sd">        programmers from using the ``hide`` method as originally</span>
<span class="sd">        intended by Qt, ie. to hide a window. However, in Qtmacs,</span>
<span class="sd">        applets can only be made invisible by either killing them with</span>
<span class="sd">        ``qteKillApplet`` or replacing them with another applet (see</span>
<span class="sd">        eg. ``qteReplaceAppletInLayout``). Using the Qt native</span>
<span class="sd">        ``hide()`` method messes with the Qtmacs layout engine and can</span>
<span class="sd">        lead to unexpected visual results and more serious errors.</span>

<span class="sd">        This method should only be used by ``QtmacsMain`` to implement</span>
<span class="sd">        the layout but not by any applets or macros, unless it is for</span>
<span class="sd">        a widget not under the control of Qtmacs (probably a bad</span>
<span class="sd">        idea).</span>

<span class="sd">        |Args|</span>

<span class="sd">        * *fromQtmacs (**bool**): if **True** then the original</span>
<span class="sd">           ``hide()`` method is called</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsArgumentError** if at least one argument has an invalid type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fromQtmacs</span><span class="p">:</span>
            <span class="c"># Log a warning message if someone tries to call the</span>
            <span class="c"># native hide() method.</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;hide() command for applet &lt;b&gt;{}&lt;/b&gt; ignored. Use &#39;</span>
                   <span class="s">&#39; qteNewApplet instead.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qteAppletID</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qteLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># If we are explicitly requested to hide() the widget,</span>
            <span class="c"># then clear the Qtmacs internal visibility flag (will be</span>
            <span class="c"># used in the focus manager to double check that Qtmacs</span>
            <span class="c"># and Qt agree on which widgets are visible), remove the</span>
            <span class="c"># applet from the QtmacsSplitter by re-parenting it to</span>
            <span class="c"># **None**, and tell Qt to actually hide the widget as</span>
            <span class="c"># soon as the event loop is in control again.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_qteAdmin</span><span class="o">.</span><span class="n">isVisible</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qteReparent</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="o">.</span><span class="n">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.setMode"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.setMode">[docs]</a>    <span class="k">def</span> <span class="nf">setMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set ``mode`` to ``value``.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * *mode (**str**): name of the mode.</span>
<span class="sd">        * *value (**object**): value associated with mode.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **QtmacsArgumentError** if at least one argument has an invalid type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_qteModes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</div>
    <span class="nd">@type_check</span>
<div class="viewcode-block" id="QtmacsApplet.getMode"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.getMode">[docs]</a>    <span class="k">def</span> <span class="nf">getMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve the value for ``mode``.</span>

<span class="sd">        If ``mode`` does not exist then raise a ``KeyError``.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * *mode (**str**): name of the mode.</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **KeyError** if ``mode`` is not a key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qteModes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="QtmacsApplet.getModeDict"><a class="viewcode-back" href="../../qtmacs_autodoc.html#qtmacs.base_applet.QtmacsApplet.getModeDict">[docs]</a>    <span class="k">def</span> <span class="nf">getModeDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a *copy* of the modes.</span>

<span class="sd">        |Args|</span>

<span class="sd">        * **None**</span>

<span class="sd">        |Returns|</span>

<span class="sd">        * **dict**: copy of the currently set modes.</span>

<span class="sd">        |Raises|</span>

<span class="sd">        * **None**</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_qteModes</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../titlepage.html">
          <img class="logo" src="../../_static/Max.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">Qtmacs 0.1 documentation</a> &raquo;</li>

          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2012-2013, Oliver Nagy.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>